#---------------------------------------------------
# libirc: an insanely flexible perl IRC library.   |
# Copyright (c) 2011, the NoTrollPlzNet developers |
# Event.pm: store & fire events on various objects |
#---------------------------------------------------
package IRC::EventObject;

use warnings;
use strict;

# $irc:
# raw_<command>
#     data: the raw IRC data


sub fire_event {
    my ($irc, $event, @arguments) = @_;
    return unless exists $irc->{events}->{$event}; # because dereferencing undef will cause an error

    # run through each event registered to that name
    foreach my $code (@{$irc->{events}->{$event}}) {
        $code->($irc, @arguments);
    }

    return 1
}

sub attach_event {
    my ($irc, $event, $code) = @_;

    # create the array ref if it doesn't exist
    if (!$irc->{events}->{$event}) {
        $irc->{events}->{$event} = [];
    }

    # add the CODE to the array ref of hooks
    push @{$irc->{events}->{$event}}, $code;

    return 1
}

1
